<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="title">PCE Risk Calculator</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="manifest" href="./manifest.json" />
    <meta name="theme-color" content="#2c3e50" />
    <script src="./lang.js"></script>
  </head>
  <body>
    <div class="language-selector">
      <select id="languageSelect">
        <option value="en">English</option>
        <option value="zh">中文</option>
        <option value="es">Español</option>
        <option value="fr">Français</option>
        <option value="de">Deutsch</option>
        <option value="ja">日本語</option>
      </select>
    </div>

    <div class="container">
      <h1 data-i18n="title">PCE Risk Calculator</h1>
      <p data-i18n="description">10-year ASCVD Risk Assessment Calculator</p>

      <form id="riskForm">
        <div class="form-group">
          <label data-i18n="form.age">Age</label>
          <input type="number" id="age" required min="40" max="79" />
        </div>

        <div class="form-group">
          <label for="sex" data-i18n="form.gender.label">Gender:</label>
          <select id="sex" required>
            <option value="male" data-i18n="form.gender.male">Male</option>
            <option value="female" data-i18n="form.gender.female">
              Female
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="race">Race:</label>
          <select id="race" required>
            <option value="asian">Asian</option>
            <option value="white">White</option>
            <option value="aa">African American</option>
            <option value="other">Other</option>
          </select>
        </div>

        <div class="form-group">
          <label for="totalChol">Total Cholesterol:</label>
          <div class="input-unit-group">
            <input type="number" id="totalChol" required step="0.01" min="0" />
            <select
              id="totalCholUnit"
              onchange="handleUnitChange('totalChol', this.value)"
            >
              <option value="mgdl">mg/dL</option>
              <option value="mmoll" selected>mmol/L</option>
            </select>
          </div>
          <small class="unit-hint" id="totalCholHint"></small>
        </div>

        <div class="form-group">
          <label for="hdl">HDL Cholesterol:</label>
          <div class="input-unit-group">
            <input type="number" id="hdl" required step="0.01" min="0" />
            <select id="hdlUnit" onchange="handleUnitChange('hdl', this.value)">
              <option value="mgdl">mg/dL</option>
              <option value="mmoll" selected>mmol/L</option>
            </select>
          </div>
          <small class="unit-hint" id="hdlHint"></small>
        </div>

        <div class="form-group">
          <label for="systolic">Systolic Blood Pressure (mmHg):</label>
          <input type="number" id="systolic" required />
          <small class="unit-hint"
            >Please enter your current systolic blood pressure, whether or not
            you are taking blood pressure medication</small
          >
        </div>

        <div class="form-group">
          <label>Are you currently taking blood pressure medication:</label>
          <input type="radio" id="bpTreatYes" name="bpTreat" value="yes" />
          <label for="bpTreatYes">Yes</label>
          <input
            type="radio"
            id="bpTreatNo"
            name="bpTreat"
            value="no"
            checked
          />
          <label for="bpTreatNo">No</label>
          <small class="unit-hint"
            >If you are currently taking blood pressure medication, please
            select "Yes"</small
          >
        </div>

        <div class="form-group">
          <label>Diabetes:</label>
          <input type="radio" id="diabetesYes" name="diabetes" value="yes" />
          <label for="diabetesYes">Yes</label>
          <input
            type="radio"
            id="diabetesNo"
            name="diabetes"
            value="no"
            checked
          />
          <label for="diabetesNo">No</label>
        </div>

        <div class="form-group">
          <label>Smoker:</label>
          <input type="radio" id="smokerYes" name="smoker" value="yes" />
          <label for="smokerYes">Yes</label>
          <input type="radio" id="smokerNo" name="smoker" value="no" checked />
          <label for="smokerNo">No</label>
        </div>

        <button type="submit">Calculate Risk</button>
      </form>

      <div id="result" class="hidden">
        <h2>Results</h2>
        <p>10-year ASCVD Risk: <span id="riskScore"></span>%</p>
        <div id="riskLevel"></div>
      </div>
    </div>
    <script src="./script.js"></script>
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("/sw.js")
            .then((registration) => {
              console.log("ServiceWorker registered successfully");
            })
            .catch((err) => {
              console.log("ServiceWorker registration failed: ", err);
            });
        });
      }
    </script>
  </body>
</html>
